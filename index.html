<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Visualizzatore Excel</title>
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .excel-table th, .excel-table td {
      border: 1px solid #ddd;
      padding: 4px 8px;
      text-align: left;
    }
    .excel-table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 10px;
    }
    .tab-content {
      margin-top: 15px;
    }
  </style>
</head>
<body class="p-4">

  <h2 class="mb-4">Visualizzatore Excel lato client</h2>

  <div id="tabs-container">
    <ul class="nav nav-tabs" id="sheetTabs" role="tablist"></ul>
    <div class="tab-content" id="sheetContent"></div>
  </div>

  <script>
    // URL del file Excel sul server
    const fileURL = "/files/miofile.xlsx"; // Cambia con il percorso corretto

    fetch(fileURL)
      .then(res => res.arrayBuffer())
      .then(data => {
        const workbook = XLSX.read(data, { type: 'array' });

        const sheetTabs = document.getElementById('sheetTabs');
        const sheetContent = document.getElementById('sheetContent');

        workbook.SheetNames.forEach((sheetName, index) => {
          const sheet = workbook.Sheets[sheetName];
          const html = XLSX.utils.sheet_to_html(sheet, { header: "", editable: false });

          // Crea la tab
          const tabId = `sheet-${index}`;
          const tab = document.createElement('li');
          tab.className = "nav-item";
          tab.innerHTML = `
            <button class="nav-link ${index === 0 ? 'active' : ''}" id="${tabId}-tab" data-bs-toggle="tab" data-bs-target="#${tabId}" type="button" role="tab">${sheetName}</button>
          `;
          sheetTabs.appendChild(tab);

          // Crea il contenuto della tab
          const tabPane = document.createElement('div');
          tabPane.className = `tab-pane fade ${index === 0 ? 'show active' : ''}`;
          tabPane.id = tabId;
          tabPane.role = "tabpanel";
          tabPane.innerHTML = html;
          sheetContent.appendChild(tabPane);
        });
      })
      .catch(error => {
        console.error("Errore nel caricamento del file Excel:", error);
      });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
